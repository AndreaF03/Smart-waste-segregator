<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Watershed Segmentation</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body class="bg-dark text-white">
    <div class="container text-center py-5">
        <h1 class="display-4">Welcome to Watershed Segmentation</h1>
        <p class="lead">Use this tool to apply watershed segmentation to images and visualize the results.</p>

        <div class="my-4">
            <h3>Upload Image for Watershed Segmentation</h3>
            <form id="uploadForm">
                <input type="file" class="form-control-file" id="imageUpload" name="image" required>
                <button type="submit" class="btn btn-primary my-3">Upload and Process</button>
            </form>
        </div>

        <div id="segmentationResult" class="my-4">
            <h4>Processed Image</h4>
            <img id="resultImage" src="" alt="Segmented Image" style="max-width: 100%; display: none;">
        </div>

        <footer class="text-center py-4">
            <p>Â© 2025 Watershed Segmentation. All rights reserved.</p>
        </footer>
    </div>

    <script>
        document.getElementById('uploadForm').addEventListener('submit', function(event) {
            event.preventDefault();

            const formData = new FormData();
            formData.append('image', document.getElementById('imageUpload').files[0]);

            axios.post('http://localhost:5000/upload', formData, {
                headers: {
                    'Content-Type': 'multipart/form-data',
                },
            })
            .then(response => {
                const resultImage = response.data.result_image;
                const resultImageUrl = `http://localhost:5000/results/${resultImage}`;
                document.getElementById('resultImage').src = resultImageUrl;
                document.getElementById('resultImage').style.display = 'block';
            })
            .catch(error => {
                console.error('There was an error!', error);
                alert('Error during image processing!');
            });
        });
    </script>
</body>
</html>
